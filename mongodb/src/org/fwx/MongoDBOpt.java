package org.fwx;

import com.alibaba.fastjson.JSON;
import com.alibaba.fastjson.JSONObject;
import com.mongodb.DBObject;
import com.mongodb.MongoClient;
import com.mongodb.WriteConcern;
import com.mongodb.client.FindIterable;
import com.mongodb.client.MongoCollection;
import com.mongodb.client.MongoCursor;
import com.mongodb.client.MongoDatabase;
import com.mongodb.client.model.InsertOneOptions;
import org.bson.Document;
import org.fwx.utils.MongoUtils;

import java.io.BufferedReader;
import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileReader;

public class MongoDBOpt {

    private static String testData = "{\"header\":{\"status\":0,\"time\":40,\"logString\":{\"queryType\":\"0010111\",\"queryValue\":\"440527197104202135\",\"totalTime\":40,\"queryRelevanceSize\":3,\"queryRelevanceTime\":6,\"queryRelationSize\":0,\"queryRelationTime\":1,\"queryRelaReleSize\":0,\"queryRelaReleTime\":0,\"queryInfoSize\":3,\"queryInfoTime\":33,\"themeSize\":3,\"relationsSize\":0,\"relevanceSize\":4,\"buildTime\":0,\"queryHbaseLogEntitys\":[{\"tableName\":\"ren2info\",\"rows\":[\"f19e1be3272f3ab849dd1388d18d03fb\",\"7f770e6b01dd323200f1442598926e7e\",\"34647b32bf7c622910df667d48eef954\"],\"ConsTime\":33}]}},\"response\":{\"data\":{\"theme\":[{\"namespace\":\"OBJ003\",\"dataset\":\"WA_OBJECT_Z002_9996\",\"dataid\":\"f19e1be3272f3ab849dd1388d18d03fb\",\"counter\":{\"count\":\"6\",\"dayCount\":\"1\",\"firstTime\":\"946656000\",\"lastTime\":\"946656000\",\"days\":[20000101],\"modelType\":\"\",\"score\":0},\"ids\":{\"H010002\":\"B02\",\"7C1200Z\":\"440527197104202135\",\"Z0021C8\":\"0010111\"},\"props\":{\"H010034\":[{\"value\":\"99\",\"score\":\"22\",\"modeltype\":\"M2\"}],\"Z0021CB\":[{\"value\":\"f19e1be3272f3ab849dd1388d18d03fb\",\"score\":\"22\",\"modeltype\":\"M2\"}],\"Z002095\":[{\"value\":\"1590941289\",\"score\":\"15\",\"modeltype\":\"M2\"}],\"B010001\":[{\"value\":\"苏俊波\",\"score\":\"22\",\"modeltype\":\"M2\"}],\"Z0020A9\":[{\"value\":\"0011000\",\"score\":\"22\",\"modeltype\":\"M2\"}],\"Z0021C7\":[{\"value\":\"440527197104202135\",\"score\":\"22\",\"modeltype\":\"M2\"}],\"7C1200Z\":[{\"value\":\"440527197104202135\",\"score\":\"22\",\"modeltype\":\"M2\"}],\"B050012\":[{\"value\":\"946656000\",\"score\":\"22\",\"modeltype\":\"M2\"}],\"B050014\":[{\"value\":\"946656000\",\"score\":\"22\",\"modeltype\":\"M2\"}],\"Z002517\":[{\"value\":\"广州市海珠中路216号房建大厦2103房\",\"score\":\"22\",\"modeltype\":\"M2\"}],\"500030B\":[{\"value\":\"440527197104202135\",\"score\":\"22\",\"modeltype\":\"M2\"}],\"Z002X59\":[{\"value\":\"M2\",\"score\":\"0\",\"modeltype\":\"\"}],\"Z002142\":[{\"value\":\"50\",\"score\":\"0\",\"modeltype\":\"\"}],\"B030005\":[{\"value\":\"440527197104202135\",\"score\":\"22\",\"modeltype\":\"M2\"}],\"B010015\":[{\"value\":\"0\",\"score\":\"22\",\"modeltype\":\"M2\"}],\"Z002743\":[{\"value\":\"A19\",\"score\":\"22\",\"modeltype\":\"M2\"}],\"B010014\":[{\"value\":\"19710420\",\"score\":\"22\",\"modeltype\":\"M2\"}],\"B010011\":[{\"value\":\"1\",\"score\":\"22\",\"modeltype\":\"M2\"}],\"B010013\":[{\"value\":\"440527\",\"score\":\"22\",\"modeltype\":\"M2\"}],\"B030004\":[{\"value\":\"111\",\"score\":\"22\",\"modeltype\":\"M2\"}],\"F010008\":[{\"value\":\"441300\",\"score\":\"0\",\"modeltype\":\"\"}],\"B050016\":[{\"value\":\"132\",\"score\":\"0\",\"modeltype\":\"\"}],\"I010005\":[{\"value\":\"946656000\",\"score\":\"0\",\"modeltype\":\"\"}]}},{\"namespace\":\"OBJ003\",\"dataset\":\"WA_OBJECT_Z002_9994\",\"dataid\":\"7f770e6b01dd323200f1442598926e7e\",\"counter\":{\"count\":\"6\",\"dayCount\":\"1\",\"firstTime\":\"946656000\",\"lastTime\":\"946656000\",\"days\":[20000101],\"modelType\":\"\",\"score\":0},\"ids\":{\"H010002\":\"B04\",\"7C1200Z\":\"460002728553482\",\"Z0021C8\":\"0020002\"},\"props\":{\"B020007\":[{\"value\":\"460002728553482\",\"score\":\"22\",\"modeltype\":\"M2\"}],\"700020B\":[{\"value\":\"460002728553482\",\"score\":\"22\",\"modeltype\":\"M2\"}],\"H010034\":[{\"value\":\"99\",\"score\":\"22\",\"modeltype\":\"M2\"}],\"B020005\":[{\"value\":\"13802740345\",\"score\":\"22\",\"modeltype\":\"M2\"}],\"Z0021CB\":[{\"value\":\"7f770e6b01dd323200f1442598926e7e\",\"score\":\"22\",\"modeltype\":\"M2\"}],\"Z002095\":[{\"value\":\"1590941289\",\"score\":\"15\",\"modeltype\":\"M2\"}],\"500020B\":[{\"value\":\"13802740345\",\"score\":\"22\",\"modeltype\":\"M2\"}],\"B030011\":[{\"value\":\"广州市海珠中路216号房建大厦2103房\",\"score\":\"22\",\"modeltype\":\"M2\"}],\"B010001\":[{\"value\":\"苏俊波\",\"score\":\"22\",\"modeltype\":\"M2\"}],\"Z002X59\":[{\"value\":\"M2\",\"score\":\"0\",\"modeltype\":\"\"}],\"Z0020A9\":[{\"value\":\"0022000\",\"score\":\"22\",\"modeltype\":\"M2\"}],\"Z0021C7\":[{\"value\":\"460002728553482\",\"score\":\"22\",\"modeltype\":\"M2\"}],\"7C1200Z\":[{\"value\":\"460002728553482\",\"score\":\"22\",\"modeltype\":\"M2\"}],\"Z002142\":[{\"value\":\"50\",\"score\":\"0\",\"modeltype\":\"\"}],\"B050012\":[{\"value\":\"946656000\",\"score\":\"22\",\"modeltype\":\"M2\"}],\"Z002743\":[{\"value\":\"A19\",\"score\":\"22\",\"modeltype\":\"M2\"}],\"B050014\":[{\"value\":\"946656000\",\"score\":\"22\",\"modeltype\":\"M2\"}],\"F010008\":[{\"value\":\"441300\",\"score\":\"0\",\"modeltype\":\"\"}],\"B050016\":[{\"value\":\"132\",\"score\":\"0\",\"modeltype\":\"\"}],\"I010005\":[{\"value\":\"946656000\",\"score\":\"0\",\"modeltype\":\"\"}]}},{\"namespace\":\"OBJ003\",\"dataset\":\"WA_OBJECT_Z002_9994\",\"dataid\":\"34647b32bf7c622910df667d48eef954\",\"counter\":{\"count\":\"10\",\"dayCount\":\"2\",\"firstTime\":\"946656000\",\"lastTime\":\"1573204597\",\"days\":[20000101,20191108],\"modelType\":\"\",\"score\":0},\"ids\":{\"H010002\":\"B04\",\"7C1200Z\":\"13802740345\",\"Z0021C8\":\"0020001\"},\"props\":{\"B020007\":[{\"value\":\"460002728553482\",\"score\":\"22\",\"modeltype\":\"M2\"}],\"700020B\":[{\"value\":\"460002728553482\",\"score\":\"22\",\"modeltype\":\"M2\"}],\"B020001\":[{\"value\":\"06\",\"score\":\"22\",\"modeltype\":\"M2\"}],\"H010034\":[{\"value\":\"99\",\"score\":\"54\",\"modeltype\":\"M2\"}],\"H010035\":[{\"value\":\"440100\",\"score\":\"22\",\"modeltype\":\"M2\"}],\"B020005\":[{\"value\":\"13802740345\",\"score\":\"22\",\"modeltype\":\"M2\"}],\"Z0021CB\":[{\"value\":\"34647b32bf7c622910df667d48eef954\",\"score\":\"54\",\"modeltype\":\"M2\"}],\"Z002095\":[{\"value\":\"1574706137\",\"score\":\"47\",\"modeltype\":\"M2\"}],\"500020B\":[{\"value\":\"13802740345\",\"score\":\"22\",\"modeltype\":\"M2\"}],\"B030011\":[{\"value\":\"广州市海珠中路216号房建大厦2103房\",\"score\":\"22\",\"modeltype\":\"M2\"}],\"B010001\":[{\"value\":\"匿名\",\"score\":\"54\",\"modeltype\":\"M2\"}],\"Z002X59\":[{\"value\":\"M2\",\"score\":\"0\",\"modeltype\":\"\"}],\"Z0020A9\":[{\"value\":\"0021000\",\"score\":\"54\",\"modeltype\":\"M2\"}],\"Z0021C7\":[{\"value\":\"13802740345\",\"score\":\"54\",\"modeltype\":\"M2\"}],\"7C1200Z\":[{\"value\":\"13802740345\",\"score\":\"54\",\"modeltype\":\"M2\"}],\"Z002142\":[{\"value\":\"82\",\"score\":\"0\",\"modeltype\":\"\"}],\"B050012\":[{\"value\":\"1573204597\",\"score\":\"54\",\"modeltype\":\"M2\"}],\"Z002743\":[{\"value\":\"D49\",\"score\":\"54\",\"modeltype\":\"M2\"}],\"B050014\":[{\"value\":\"1573204597\",\"score\":\"54\",\"modeltype\":\"M2\"}],\"Z002096\":[{\"value\":\":;X910Z26\",\"score\":\"0\",\"modeltype\":\"\"}],\"F010008\":[{\"value\":\"441300:;441300\",\"score\":\"0\",\"modeltype\":\"\"}],\"B050016\":[{\"value\":\"132:;910\",\"score\":\"0\",\"modeltype\":\"\"}],\"I010005\":[{\"value\":\"946656000:;1573204597\",\"score\":\"0\",\"modeltype\":\"\"}]}}],\"relations\":[],\"relavance\":[{\"firsttime\":\"946656000\",\"Z002142\":\"13.53352832366127\",\"elementA\":\"7f770e6b01dd323200f1442598926e7e\",\"elementB\":\"f19e1be3272f3ab849dd1388d18d03fb\",\"relationCode\":\"000\",\"count\":\"2\",\"B050016\":\"132\",\"traceDataId\":\"5547394495abee399ab4635861b8c01b\",\"Z002X59\":\"M99\",\"traceCode\":\"010101-010107-065-000\",\"lasttime\":\"946656000\",\"relaDetailCode\":\"000-000\",\"Z0021L3\":\"1\",\"Z002Z01\":\"010101-010107-000-000\",\"days\":\"20000101\"},{\"firsttime\":\"946656000\",\"Z002142\":\"32.78132291972606\",\"elementA\":\"f19e1be3272f3ab849dd1388d18d03fb\",\"elementB\":\"34647b32bf7c622910df667d48eef954\",\"relationCode\":\"000\",\"count\":\"2\",\"B050016\":\"132\",\"traceDataId\":\"fbbf9d363d9959d59a95c40e10f9f418,42477a25c7988a3c50edfdfa170ca7cd\",\"Z002X59\":\"M99\",\"traceCode\":\"010101-010106-065-000,010101-010106-022-003\",\"lasttime\":\"946656000\",\"relaDetailCode\":\"000-000\",\"Z0021L3\":\"1\",\"Z002Z01\":\"010101-010106-000-000\",\"days\":\"20000101\"},{\"firsttime\":\"946656000\",\"Z002142\":\"32.78132291972606\",\"elementA\":\"34647b32bf7c622910df667d48eef954\",\"elementB\":\"f19e1be3272f3ab849dd1388d18d03fb\",\"relationCode\":\"000\",\"count\":\"2\",\"B050016\":\"132\",\"traceDataId\":\"8fcf4cc7299e7ba0bb7b7d1662dbcdda,96b5cf61bc32d0a06a4648d72ba82521\",\"Z002X59\":\"M99\",\"traceCode\":\"010101-010106-065-000,010101-010106-022-003\",\"lasttime\":\"946656000\",\"relaDetailCode\":\"000-000\",\"Z0021L3\":\"1\",\"Z002Z01\":\"010101-010106-000-000\",\"days\":\"20000101\"},{\"firsttime\":\"946656000\",\"Z002142\":\"13.53352832366127\",\"elementA\":\"f19e1be3272f3ab849dd1388d18d03fb\",\"elementB\":\"7f770e6b01dd323200f1442598926e7e\",\"relationCode\":\"000\",\"count\":\"2\",\"B050016\":\"132\",\"traceDataId\":\"9409d2a0d5640304e2e732d03c682a87\",\"Z002X59\":\"M99\",\"traceCode\":\"010101-010107-065-000\",\"lasttime\":\"946656000\",\"relaDetailCode\":\"000-000\",\"Z0021L3\":\"1\",\"Z002Z01\":\"010101-010107-000-000\",\"days\":\"20000101\"}]}}}";
    private static String testData1 = "{\"header\":{\"status\":0,\"time\":2444,\"logString\":{\"queryType\":\"0010111\",\"queryValue\":\"511381198911021155\",\"totalTime\":2444,\"queryRelevanceSize\":3,\"queryRelevanceTime\":242,\"queryRelationSize\":0,\"queryRelationTime\":1751,\"queryRelaReleSize\":0,\"queryRelaReleTime\":0,\"queryInfoSize\":3,\"queryInfoTime\":444,\"themeSize\":3,\"relationsSize\":0,\"relevanceSize\":4,\"buildTime\":7,\"queryHbaseLogEntitys\":[{\"tableName\":\"ren2info\",\"rows\":[\"2647be45d1e39bd23e4b54008f7bdb81\",\"3bf2b7dc2cbbd89b1194bf8802a7703e\",\"651fe668e3f97099b9038343b75d9b9d\"],\"ConsTime\":45}]}},\"response\":{\"data\":{\"theme\":[{\"namespace\":\"OBJ003\",\"dataset\":\"WA_OBJECT_Z002_9994\",\"dataid\":\"2647be45d1e39bd23e4b54008f7bdb81\",\"counter\":{\"count\":\"45\",\"dayCount\":\"4\",\"firstTime\":\"1541059662\",\"lastTime\":\"1646014412\",\"days\":[20200308,20200304,20220228,20181101],\"modelType\":\"\",\"score\":0},\"ids\":{\"H010002\":\"B04\",\"7C1200Z\":\"13392879994\",\"Z0021C8\":\"0020001\"},\"props\":{\"B020007\":[{\"value\":\"460037830332743\",\"score\":\"42\",\"modeltype\":\"M2\"}],\"700020B\":[{\"value\":\"460037830332743\",\"score\":\"42\",\"modeltype\":\"M2\"}],\"Z002X59\":[{\"value\":\"M99\",\"score\":\"52\",\"modeltype\":\"M99\"}],\"B020001\":[{\"value\":\"01\",\"score\":\"66\",\"modeltype\":\"M2\"}],\"H010034\":[{\"value\":\"99\",\"score\":\"66\",\"modeltype\":\"M2\"}],\"Z0020A9\":[{\"value\":\"0021000\",\"score\":\"66\",\"modeltype\":\"M2\"}],\"H010035\":[{\"value\":\"440300\",\"score\":\"66\",\"modeltype\":\"M2\"}],\"B020005\":[{\"value\":\"13392879994\",\"score\":\"66\",\"modeltype\":\"M2\"}],\"Z0021C7\":[{\"value\":\"13392879994\",\"score\":\"66\",\"modeltype\":\"M2\"}],\"7C1200Z\":[{\"value\":\"13392879994\",\"score\":\"66\",\"modeltype\":\"M2\"}],\"Z002142\":[{\"value\":\"52\",\"score\":\"52\",\"modeltype\":\"M99\"}],\"Z0021CB\":[{\"value\":\"2647be45d1e39bd23e4b54008f7bdb81\",\"score\":\"66\",\"modeltype\":\"M2\"}],\"B050012\":[{\"value\":\"1646014412\",\"score\":\"0\",\"modeltype\":\"\"}],\"Z002095\":[{\"value\":\"1583667845\",\"score\":\"51\",\"modeltype\":\"M2\"}],\"Z002743\":[{\"value\":\"A4B\",\"score\":\"0\",\"modeltype\":\"\"}],\"500020B\":[{\"value\":\"13392879994\",\"score\":\"66\",\"modeltype\":\"M2\"}],\"B030011\":[{\"value\":\"广东省深圳市宝安区宝城27区来辉历苑A1-1003\",\"score\":\"42\",\"modeltype\":\"M2\"}],\"Z002442\":[{\"value\":\"未知号码\",\"score\":\"66\",\"modeltype\":\"M2\"}],\"B050014\":[{\"value\":\"1646014412\",\"score\":\"0\",\"modeltype\":\"\"}],\"B010001\":[{\"value\":\"未知号码\",\"score\":\"66\",\"modeltype\":\"M2\"}],\"Z002096\":[{\"value\":\"A4B9999\",\"score\":\"100\",\"modeltype\":\"\"}],\"F010008\":[{\"value\":\"441300\",\"score\":\"100\",\"modeltype\":\"\"}],\"B050016\":[{\"value\":\"132:;137\",\"score\":\"100\",\"modeltype\":\"\"}]}},{\"namespace\":\"OBJ003\",\"dataset\":\"WA_OBJECT_Z002_9996\",\"dataid\":\"3bf2b7dc2cbbd89b1194bf8802a7703e\",\"counter\":{\"count\":\"6\",\"dayCount\":\"1\",\"firstTime\":\"1541059662\",\"lastTime\":\"1541059662\",\"days\":[20181101],\"modelType\":\"\",\"score\":0},\"ids\":{\"H010002\":\"B02\",\"7C1200Z\":\"511381198911021155\",\"Z0021C8\":\"0010111\"},\"props\":{\"H010034\":[{\"value\":\"99\",\"score\":\"42\",\"modeltype\":\"M2\"}],\"Z0021CB\":[{\"value\":\"3bf2b7dc2cbbd89b1194bf8802a7703e\",\"score\":\"42\",\"modeltype\":\"M2\"}],\"Z002095\":[{\"value\":\"1590942295\",\"score\":\"35\",\"modeltype\":\"M2\"}],\"B010001\":[{\"value\":\"任军\",\"score\":\"42\",\"modeltype\":\"M2\"}],\"Z0020A9\":[{\"value\":\"0011000\",\"score\":\"42\",\"modeltype\":\"M2\"}],\"Z0021C7\":[{\"value\":\"511381198911021155\",\"score\":\"42\",\"modeltype\":\"M2\"}],\"7C1200Z\":[{\"value\":\"511381198911021155\",\"score\":\"42\",\"modeltype\":\"M2\"}],\"B050012\":[{\"value\":\"1541059662\",\"score\":\"42\",\"modeltype\":\"M2\"}],\"B050014\":[{\"value\":\"1541059662\",\"score\":\"42\",\"modeltype\":\"M2\"}],\"Z002517\":[{\"value\":\"广东省深圳市宝安区宝城27区来辉历苑A1-1003\",\"score\":\"42\",\"modeltype\":\"M2\"}],\"500030B\":[{\"value\":\"511381198911021155\",\"score\":\"42\",\"modeltype\":\"M2\"}],\"Z002X59\":[{\"value\":\"M2\",\"score\":\"0\",\"modeltype\":\"\"}],\"Z002142\":[{\"value\":\"70\",\"score\":\"0\",\"modeltype\":\"\"}],\"B030005\":[{\"value\":\"511381198911021155\",\"score\":\"42\",\"modeltype\":\"M2\"}],\"B010015\":[{\"value\":\"0\",\"score\":\"42\",\"modeltype\":\"M2\"}],\"Z002743\":[{\"value\":\"A19\",\"score\":\"42\",\"modeltype\":\"M2\"}],\"B010014\":[{\"value\":\"19891102\",\"score\":\"42\",\"modeltype\":\"M2\"}],\"B010011\":[{\"value\":\"1\",\"score\":\"42\",\"modeltype\":\"M2\"}],\"B010013\":[{\"value\":\"511381\",\"score\":\"42\",\"modeltype\":\"M2\"}],\"B030004\":[{\"value\":\"111\",\"score\":\"42\",\"modeltype\":\"M2\"}],\"F010008\":[{\"value\":\"441300\",\"score\":\"0\",\"modeltype\":\"\"}],\"B050016\":[{\"value\":\"132\",\"score\":\"0\",\"modeltype\":\"\"}],\"I010005\":[{\"value\":\"1541059662\",\"score\":\"0\",\"modeltype\":\"\"}]}},{\"namespace\":\"OBJ003\",\"dataset\":\"WA_OBJECT_Z002_9994\",\"dataid\":\"651fe668e3f97099b9038343b75d9b9d\",\"counter\":{\"count\":\"6\",\"dayCount\":\"1\",\"firstTime\":\"1541059662\",\"lastTime\":\"1541059662\",\"days\":[20181101],\"modelType\":\"\",\"score\":0},\"ids\":{\"H010002\":\"B04\",\"7C1200Z\":\"460037830332743\",\"Z0021C8\":\"0020002\"},\"props\":{\"B020007\":[{\"value\":\"460037830332743\",\"score\":\"42\",\"modeltype\":\"M2\"}],\"700020B\":[{\"value\":\"460037830332743\",\"score\":\"42\",\"modeltype\":\"M2\"}],\"H010034\":[{\"value\":\"99\",\"score\":\"42\",\"modeltype\":\"M2\"}],\"B020005\":[{\"value\":\"13392879994\",\"score\":\"42\",\"modeltype\":\"M2\"}],\"Z0021CB\":[{\"value\":\"651fe668e3f97099b9038343b75d9b9d\",\"score\":\"42\",\"modeltype\":\"M2\"}],\"Z002095\":[{\"value\":\"1590942295\",\"score\":\"35\",\"modeltype\":\"M2\"}],\"500020B\":[{\"value\":\"13392879994\",\"score\":\"42\",\"modeltype\":\"M2\"}],\"B030011\":[{\"value\":\"广东省深圳市宝安区宝城27区来辉历苑A1-1003\",\"score\":\"42\",\"modeltype\":\"M2\"}],\"B010001\":[{\"value\":\"任军\",\"score\":\"42\",\"modeltype\":\"M2\"}],\"Z002X59\":[{\"value\":\"M2\",\"score\":\"0\",\"modeltype\":\"\"}],\"Z0020A9\":[{\"value\":\"0022000\",\"score\":\"42\",\"modeltype\":\"M2\"}],\"Z0021C7\":[{\"value\":\"460037830332743\",\"score\":\"42\",\"modeltype\":\"M2\"}],\"7C1200Z\":[{\"value\":\"460037830332743\",\"score\":\"42\",\"modeltype\":\"M2\"}],\"Z002142\":[{\"value\":\"70\",\"score\":\"0\",\"modeltype\":\"\"}],\"B050012\":[{\"value\":\"1541059662\",\"score\":\"42\",\"modeltype\":\"M2\"}],\"Z002743\":[{\"value\":\"A19\",\"score\":\"42\",\"modeltype\":\"M2\"}],\"B050014\":[{\"value\":\"1541059662\",\"score\":\"42\",\"modeltype\":\"M2\"}],\"F010008\":[{\"value\":\"441300\",\"score\":\"0\",\"modeltype\":\"\"}],\"B050016\":[{\"value\":\"132\",\"score\":\"0\",\"modeltype\":\"\"}],\"I010005\":[{\"value\":\"1541059662\",\"score\":\"0\",\"modeltype\":\"\"}]}}],\"relations\":[],\"relavance\":[{\"firsttime\":\"1541059662\",\"Z002142\":\"51.148824460561336\",\"elementA\":\"651fe668e3f97099b9038343b75d9b9d\",\"elementB\":\"3bf2b7dc2cbbd89b1194bf8802a7703e\",\"relationCode\":\"000\",\"count\":\"2\",\"B050016\":\"132\",\"traceDataId\":\"648fed6d43aec5de4de0754a2b325a0b\",\"Z002X59\":\"M99\",\"traceCode\":\"010101-010107-065-000\",\"lasttime\":\"1541059662\",\"relaDetailCode\":\"000-000\",\"Z0021L3\":\"1\",\"Z002Z01\":\"010101-010107-000-000\",\"days\":\"20181101\"},{\"firsttime\":\"1541059662\",\"Z002142\":\"51.148824460561336\",\"elementA\":\"3bf2b7dc2cbbd89b1194bf8802a7703e\",\"elementB\":\"651fe668e3f97099b9038343b75d9b9d\",\"relationCode\":\"000\",\"count\":\"2\",\"B050016\":\"132\",\"traceDataId\":\"32021382300a976a20b3e04747c02b8b\",\"Z002X59\":\"M99\",\"traceCode\":\"010101-010107-065-000\",\"lasttime\":\"1541059662\",\"relaDetailCode\":\"000-000\",\"Z0021L3\":\"1\",\"Z002Z01\":\"010101-010107-000-000\",\"days\":\"20181101\"},{\"firsttime\":\"1541059662\",\"Z002142\":\"42.185146953951076\",\"elementA\":\"2647be45d1e39bd23e4b54008f7bdb81\",\"elementB\":\"3bf2b7dc2cbbd89b1194bf8802a7703e\",\"relationCode\":\"000\",\"count\":\"2\",\"B050016\":\"132\",\"traceDataId\":\"304b803b1785b0234dc6cd19c26010a0,b9a8eb8ff6706dfdcb7de27e1804b868\",\"Z002X59\":\"M99\",\"traceCode\":\"010101-010106-065-000,010101-010106-022-003\",\"lasttime\":\"1541059662\",\"relaDetailCode\":\"000-000\",\"Z0021L3\":\"1\",\"Z002Z01\":\"010101-010106-000-000\",\"days\":\"20181101\"},{\"firsttime\":\"1541059662\",\"Z002142\":\"42.185146953951076\",\"elementA\":\"3bf2b7dc2cbbd89b1194bf8802a7703e\",\"elementB\":\"2647be45d1e39bd23e4b54008f7bdb81\",\"relationCode\":\"000\",\"count\":\"2\",\"B050016\":\"132\",\"traceDataId\":\"1746b4bd465f41ffb8527d2645198fc3,c0838ef9f464c2d70ba55604db156033\",\"Z002X59\":\"M99\",\"traceCode\":\"010101-010106-065-000,010101-010106-022-003\",\"lasttime\":\"1541059662\",\"relaDetailCode\":\"000-000\",\"Z0021L3\":\"1\",\"Z002Z01\":\"010101-010106-000-000\",\"days\":\"20181101\"}]}}}\n";

    public static void main(String[] args) throws Exception {

        // 一条大数据 276MB  会报错！！！
        // Exception in thread "main" org.bson.BsonSerializationException: Document size of 304979881 is larger than maximum of 16777216.
//        BufferedReader reader = new BufferedReader(new FileReader(new File("C:\\Users\\Administrator\\Desktop\\惠州\\RuMongoDB\\physical\\json\\oneBigData")));
        BufferedReader reader = new BufferedReader(new FileReader(new File("C:\\Users\\Administrator\\Desktop\\惠州\\part-00000\\part-00000")));
        String bigData = reader.readLine();

        // 物理建档 json 解析 header 中的 关系关联等统计数据量值
        JSONObject jsonObject = (JSONObject)JSON.parse(bigData);
        JSONObject header = jsonObject.getObject("header", JSONObject.class);
        JSONObject logString = header.getObject("logString", JSONObject.class);
        Integer queryRelevanceSize = logString.getInteger("queryRelevanceSize");
        Integer queryRelationSize = logString.getInteger("queryRelationSize");
        Integer queryRelaReleSize = logString.getInteger("queryRelaReleSize");
        Integer queryInfoSize = logString.getInteger("queryInfoSize");
        System.out.println(queryRelevanceSize+","+queryRelationSize+","+queryRelaReleSize+","+queryInfoSize);


        // 获取 MongoDB 客户端对象
        MongoClient mongoClient = MongoUtils.getMongoClient();
        System.out.println("mongoClient===:"+mongoClient);

        // 获取数据库对象
        MongoDatabase database = mongoClient.getDatabase("test");

        // 获取集合对象
        MongoCollection<Document> collection = database.getCollection("student");

        // 查询所有数据，控制台打印信息
//        FindIterable<Document> documents = collection.find();
//        MongoUtils.printDocument(documents.iterator());

        // 新增数据
        Document document = Document.parse(testData);
//        Document document = Document.parse(bigData);
        collection.insertOne(document,new InsertOneOptions());


        MongoUtils.close();
    }
}
